<head>
    <link rel="stylesheet" href="/technical-styles/manage-keys.css" />
    <script src="/technical-scripts/oauth2-key-generation.js" defer></script>
    <script src="/technical-scripts/api-key-generation.js" defer></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
</head>
<main>
    {{> header profile=profile baseUrl=baseUrl devportalMode=devportalMode }}
    {{> sidebar profile=profile baseUrl=baseUrl devportalMode=devportalMode }}
    <section class="section keys-section">
        <div>
            <div class="container-header mb-4 d-sm-flex justify-content-between align-items-center">Manage Keys</div>
        </div>

        <ul class="nav nav-tabs key-btn-container" id="keysTab" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="key-btn active" id="production-tab" data-bs-toggle="tab" data-bs-target="#production"
                    type="button" role="tab" aria-controls="production" aria-selected="true">
                    Production
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="key-btn" id="sandbox-tab" data-bs-toggle="tab" data-bs-target="#sandbox" type="button"
                    role="tab" aria-controls="sandbox" aria-selected="false">
                    Sandbox
                </button>
            </li>
        </ul>

        <div class="tab-content" id="keysTabContent">
            <div class="tab-pane fade show active" id="production" role="tabpanel" aria-labelledby="production-tab">
                <div class="accordion" id="productionAccordion">
                    <div class="accordion-item mb-3">
                        <h2 class="accordion-header" id="headingThree">
                            <button class="accordion-button" type="button" data-bs-toggle="collapse"
                                data-bs-target="#collapseThree" aria-expanded="true" aria-controls="collapseThree">
                                OAuth2 Keys
                            </button>
                        </h2>
                        <div id="collapseThree" class="accordion-collapse collapse show" aria-labelledby="headingThree"
                            data-bs-parent="#productionAccordion">
                            <div class="accordion-body">
                                {{#each keyManagersMetadata}}
                                {{#if enabled}}
                                {{#let "keys" productionKeys}}
                                {{#if keys.consumerKey}}
                                <div class="mb-4">
                                    <div class="col mb-3">
                                        <div id="consumerKey"
                                            class="{{#unless keys.consumerSecret}} col-md-12 {{else}} col-md-6 {{/unless}}">
                                            <label for='consumer-key-{{../id}}-PRODUCTION' class='form-label'>
                                                Consumer Key
                                            </label>
                                            <div class="password-toggle-container">
                                                <input type='text' id='consumer-key-{{../id}}-PRODUCTION-view'
                                                    class='form-control' name="consumerKey" value='{{keys.consumerKey}}'
                                                    readonly disabled />
                                                <button type="button" class="password-copy-btn"
                                                    onclick="copyConsumerKey('consumer-key-{{../id}}-PRODUCTION')">
                                                    <i class="bi bi-clipboard"></i>
                                                </button>
                                            </div>
                                            <input type='hidden' id='app-ref-{{../id}}-PRODUCTION' class='form-control'
                                                name="appRefId" value='{{keys.appRefId}}' />
                                            <input type='hidden' id='key-map-{{../id}}-PRODUCTION' class='form-control'
                                                name="keyMappingId" value='{{keys.keyMappingId}}' />
                                        </div>
                                        <div id="consumerSecret" class="col-md-6"
                                            style="{{#unless keys.consumerSecret}} display: none; {{/unless}}">
                                            <label for='consumer-secret-{{../id}}-PRODUCTION' class='form-label'>
                                                Consumer Secret
                                            </label>
                                            <div class="password-toggle-container">
                                                <input type='password' id='consumer-secret-{{../id}}-PRODUCTION'
                                                    class='form-control' name="consumerSecret"
                                                    value='{{keys.consumerSecret}}' readonly disabled />
                                                <button type="button" class="password-toggle-btn"
                                                    onclick="togglePasswordVisibility('consumer-secret-{{../id}}-PRODUCTION')">
                                                    <i class="bi bi-eye"></i>
                                                </button>
                                                <button type="button" class="password-copy-btn"
                                                    onclick="copyConsumerSecret('consumer-secret-{{../id}}-PRODUCTION')">
                                                    <i class="bi bi-clipboard"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="keyActionsContainer-PRODUCTION" class="key-actions-container">
                                    <div class="key-action-row">
                                        <div class="key-action-buttons-row">
                                            <button id="viewKeyBtn-PRODUCTION" class="common-btn-outlined btn-sm"
                                                onclick="loadKeysViewModal('PRODUCTION')">
                                                <i class="bi bi-eye"></i> View
                                            </button>
                                            <button id="modifyKeyBtn-PRODUCTION"
                                                class="common-btn-outlined btn-sm {{#if @root.isReadOnlyMode}}disabled{{/if}}"
                                                style="{{#if @root.isReadOnlyMode}}pointer-events: none; opacity: 0.5;{{/if}}"
                                                onclick="loadKeysModifyModal('PRODUCTION')">
                                                <i class="bi bi-pencil-square"></i> Modify
                                            </button>
                                            <button id="tokenKeyBtn-PRODUCTION"
                                                class="common-btn-outlined btn-sm {{#if @root.isReadOnlyMode}}disabled{{/if}}"
                                                data-app-id="{{@root.applicationMetadata.id}}"
                                                style="{{#if @root.isReadOnlyMode}}pointer-events: none; opacity: 0.5;{{/if}}"
                                                onclick="generateOauthKey('applicationKeyGenerateForm-{{../id}}-PRODUCTION', '{{keys.appRefID}}', '{{keys.keyMappingId}}', '{{../name}}', '{{../../applicationMetadata/name}}', '{{keys.consumerSecret}}', '{{json @root.subscriptionScopes}}', 'PRODUCTION')">
                                                <span class="button-normal-state">
                                                    <i class="bi bi-key-fill"></i> Generate
                                                </span>
                                                <span class="button-loading-state" style="display: none;">
                                                    <span class="spinner-border spinner-border-sm me-1"
                                                        role="status"></span>
                                                    Generating...
                                                </span>
                                            </button>
                                            <button id="tokenInstructionsBtn-PRODUCTION" class="common-btn-outlined btn-sm"
                                                onclick="loadKeysInstructionsModal('PRODUCTION')">
                                                <i class="bi bi-info-circle"></i> Instructions
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                {{else}}
                                <div id="generateKeyContainer-PRODUCTION">
                                    <div class="d-flex align-items-center">
                                    <button data-cyid="generateKey-PRODUCTION" id="generateKeyBtn-PRODUCTION"
                                        class="common-btn-primary btn-sm {{#if @root.isReadOnlyMode}}disabled{{/if}}"
                                        style="{{#if @root.isReadOnlyMode}}pointer-events: none; opacity: 0.5;{{/if}}"
                                        onclick="generateApplicationKey('keysview-{{../id}}-PRODUCTION', '{{../../applicationMetadata.id}}', 'PRODUCTION', '{{../name}}', '{{../../applicationMetadata/name}}', '{{ json ../../subAPIs}}', '{{../../orgID}}', 'consumer-key-{{../id}}-PRODUCTION', 'consumer-secret-{{../id}}-PRODUCTION')">
                                        <span class="button-normal-state">
                                            <i class="bi bi-key me-1"></i> Generate Key
                                        </span>
                                        <span class="button-loading-state" style="display: none;">
                                            <span class="spinner-border spinner-border-sm me-1" role="status"></span>
                                            Generating...
                                        </span>
                                    </button>
                                </div>
                                </div>
                                {{/if}}
                                {{/let}}
                                {{/if}}
                                <!-- Error message container for key generation and token generation -->
                                <div id="keyGenerationErrorContainer-PRODUCTION" class="mt-2 text-danger"
                                    style="display: none; font-size: 0.75rem; word-wrap: break-word;"></div>
                                {{/each}}
                            </div>
                        </div>
                    </div>
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingFour">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                data-bs-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
                                API Keys
                            </button>
                        </h2>
                        <div id="collapseFour" class="accordion-collapse collapse" aria-labelledby="headingFour"
                            data-bs-parent="#productionAccordion">
                            <div class="accordion-body p-0">
                                {{#if subAPIs}}
                                <div class="app-table-container" id="app-table-container">
                                    <table class="app-table" id="app-table-{{applicationMetadata.id}}">
                                        <thead>
                                            <tr>
                                                <th class="app-th">Name</th>
                                                <th class="app-th">Version</th>
                                                <th class="app-th">
                                                    {{#if isApiKey}}
                                                    API Key
                                                    {{/if}}
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {{#each subAPIs}}
                                            {{> api-key apiID=apiID keyType="PRODUCTION"}}
                                            {{#in apiType values="REST, WS"}}
                                            {{> update-plan subscriptionPolicyDetails=subscriptionPolicyDetails
                                            selectedPlan=policyName appID=../applicationMetadata.id subID=subID}}
                                            <tr class="data-row" id="data-row-{{subID}}" data-index="{{@index}}">
                                                <td class="app-td">
                                                    <span
                                                        onclick="window.location.href='{{@root.baseUrl}}/api/{{apiHandle}}'"
                                                        class="text-truncate d-block"
                                                        style="cursor: pointer;">{{name}}</span>
                                                </td>
                                                <td onclick="window.location.href='{{@root.baseUrl}}/api/{{apiHandle}}'"
                                                    class="app-td" style="cursor: pointer;">{{version}}</td>
                                                <td id="policy_{{subID}}" class="app-td" style="display: none;">{{policyName}}</td>
                                                <td class="app-td">
                                                    {{#if (contains security 'api_key')}}
                                                    <div class="api-key-actions">
                                                        <button
                                                            class="common-btn-outlined btn-sm me-1 {{#if @root.isReadOnlyMode}}disabled{{/if}}"
                                                            id="regenerateKeyBtn-{{subID}}-PRODUCTION"
                                                            data-scopes="{{json apiKeys.production.scopes}}"
                                                            data-api-key-id="'{{apiKeys.production.key.[0].id}}'"
                                                            onclick="openWarningModal('regenerate', this.dataset.apiKeyId, '{{subID}}', '', '', 'PRODUCTION')"
                                                            style="{{#if @root.isReadOnlyMode}}pointer-events: none; opacity: 0.5;{{else}}{{#if apiKeys.production.key}}display:inline-flex;{{else}}display:none;{{/if}}{{/if}}">
                                                            <span class="button-normal-state">
                                                                <i class="bi bi-key me-1"></i> Regenerate
                                                            </span>
                                                            <span class="button-loading-state" style="display: none;">
                                                                <span class="spinner-border spinner-border-sm me-1"
                                                                    role="status"></span>
                                                                Regenerate...
                                                            </span>
                                                        </button>
                                                        <button
                                                            class="common-btn-outlined btn-sm api-key-revoke {{#if @root.isReadOnlyMode}}disabled{{/if}}"
                                                            data-api-key-id="'{{apiKeys.production.key.[0].id}}'"
                                                            onclick="openWarningModal('revoke', this.dataset.apiKeyId, '{{subID}}', '{{../applicationMetadata.id}}', '{{refID}}', 'PRODUCTION')"
                                                            id="revokeKeyBtn-{{subID}}-PRODUCTION"
                                                            style="{{#if @root.isReadOnlyMode}}pointer-events: none; opacity: 0.5;{{else}}{{#if apiKeys.production.key}}display: inline-flex;{{else}}display: none;{{/if}}{{/if}}">
                                                            <span class="button-normal-state">
                                                                <i class="bi bi-key me-1"></i> Revoke
                                                            </span>
                                                            <span class="button-loading-state" style="display: none;">
                                                                <span class="spinner-border spinner-border-sm me-1"
                                                                    role="status"></span>
                                                                Revoking...
                                                            </span>
                                                        </button>
                                                        <button
                                                            class="common-btn-outlined btn-sm me-1 {{#if @root.isReadOnlyMode}}disabled{{/if}}"
                                                            id="generateKeyBtn-{{subID}}-PRODUCTION"
                                                            style="{{#if apiKeys.production.key}}display: none;{{else}}display: inline-flex;{{/if}}"
                                                            data-app-ref-id=""
                                                            onclick="openApiKeyModal('{{projectId}}', '{{refID}}', '{{policyName}}', '{{../applicationMetadata.appMap.[0].appRefID}}', '{{../applicationMetadata.id}}', '{{subID}}', '{{getSubIDs ../subAPIs}}', '{{json scopes}}', 'PRODUCTION')">
                                                            <span class="button-normal-state">
                                                                <i class="bi bi-key me-1"></i> Generate Key
                                                            </span>
                                                            <span class="button-loading-state" style="display: none;">
                                                                <span class="spinner-border spinner-border-sm me-1"
                                                                    role="status"></span>
                                                                Generating...
                                                            </span>
                                                        </button>
                                                    </div>
                                                    {{/if}}
                                                </td>
                                            </tr>
                                            {{/in}}
                                            {{/each}}
                                        </tbody>
                                    </table>
                                </div>
                                {{/if}}
                                <div class="ps-3" id="no-subscription"
                                    style="{{#if subAPIs.length}}display:none{{/if}}">
                                    <div class="info-box">
                                        <div class="info-content">
                                            <div class="info-title">
                                                No subscriptions available for this application. Please subscribe to an
                                                API.
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="tab-pane fade" id="sandbox" role="tabpanel" aria-labelledby="sandbox-tab">
                <div class="alert alert-info d-flex align-items-center mb-3" role="alert">
                    <i class="bi bi-info-circle-fill me-2"></i>
                    <div>
                        These keys can be used only for the sandbox environment.
                    </div>
                </div>

                <div class="accordion" id="sandboxAccordion">
                    <div class="accordion-item mb-3">
                        <h2 class="accordion-header" id="headingOne">
                            <button class="accordion-button" type="button" data-bs-toggle="collapse"
                                data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                OAuth2 Keys
                            </button>
                        </h2>
                        <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne"
                            data-bs-parent="#sandboxAccordion">
                            <div class="accordion-body">
                                {{#each keyManagersMetadata}}
                                {{#if enabled}}
                                {{#let "keys" sandboxKeys}}
                                {{#if keys.consumerKey}}
                                <div class="mb-4">
                                    <div class="col mb-3">
                                        <div id="consumerKey"
                                            class="{{#unless keys.consumerSecret}} col-md-12 {{else}} col-md-6 {{/unless}}">
                                            <label for='consumer-key-{{../id}}-SANDBOX' class='form-label'>
                                                Consumer Key
                                            </label>
                                            <div class="password-toggle-container">
                                                <input type='text' id='consumer-key-{{../id}}-SANDBOX-view'
                                                    class='form-control' name="consumerKey" value='{{keys.consumerKey}}'
                                                    readonly disabled />
                                                <button type="button" class="password-copy-btn"
                                                    onclick="copyConsumerKey('consumer-key-{{../id}}-SANDBOX')">
                                                    <i class="bi bi-clipboard"></i>
                                                </button>
                                            </div>
                                            <input type='hidden' id='app-ref-{{../id}}-SANDBOX' class='form-control'
                                                name="appRefId" value='{{keys.appRefId}}' />
                                            <input type='hidden' id='key-map-{{../id}}-SANDBOX' class='form-control'
                                                name="keyMappingId" value='{{keys.keyMappingId}}' />
                                        </div>
                                        <div id="consumerSecret" class="col-md-6"
                                            style="{{#unless keys.consumerSecret}} display: none; {{/unless}}">
                                            <label for='consumer-secret-{{../id}}-SANDBOX' class='form-label'>
                                                Consumer Secret
                                            </label>
                                            <div class="password-toggle-container">
                                                <input type='password' id='consumer-secret-{{../id}}-SANDBOX'
                                                    class='form-control' name="consumerSecret"
                                                    value='{{keys.consumerSecret}}' readonly disabled />
                                                <button type="button" class="password-toggle-btn"
                                                    onclick="togglePasswordVisibility('consumer-secret-{{../id}}-SANDBOX')">
                                                    <i class="bi bi-eye"></i>
                                                </button>
                                                <button type="button" class="password-copy-btn"
                                                    onclick="copyConsumerSecret('consumer-secret-{{../id}}-SANDBOX')">
                                                    <i class="bi bi-clipboard"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="keyActionsContainer-SANDBOX" class="key-actions-container">
                                    <div class="key-action-row">
                                        <div class="key-action-buttons-row">
                                            <button id="viewKeyBtn-SANDBOX" class="common-btn-outlined btn-sm"
                                                onclick="loadKeysViewModal('SANDBOX')">
                                                <i class="bi bi-eye"></i> View
                                            </button>
                                            <button id="modifyKeyBtnSandbox"
                                                class="common-btn-outlined btn-sm {{#if @root.isReadOnlyMode}}disabled{{/if}}"
                                                style="{{#if @root.isReadOnlyMode}}pointer-events: none; opacity: 0.5;{{/if}}"
                                                onclick="loadKeysModifyModal('SANDBOX')">
                                                <i class="bi bi-pencil-square"></i> Modify
                                            </button>
                                            <button id="tokenKeyBtn-SANDBOX"
                                                class="common-btn-outlined btn-sm {{#if @root.isReadOnlyMode}}disabled{{/if}}"
                                                data-app-id="{{@root.applicationMetadata.id}}"
                                                style="{{#if @root.isReadOnlyMode}}pointer-events: none; opacity: 0.5;{{/if}}"
                                                onclick="generateOauthKey('applicationKeyGenerateForm-{{../id}}-SANDBOX', '{{keys.appRefID}}', '{{keys.keyMappingId}}', '{{../name}}', '{{../../applicationMetadata/name}}', '{{keys.consumerSecret}}', '{{json @root.subscriptionScopes}}', 'SANDBOX')">
                                                <span class="button-normal-state">
                                                    <i class="bi bi-key-fill"></i> Generate
                                                </span>
                                                <span class="button-loading-state" style="display: none;">
                                                    <span class="spinner-border spinner-border-sm me-1"
                                                        role="status"></span>
                                                    Generating...
                                                </span>
                                            </button>
                                            <button id="tokenInstructionsBtn-SANDBOX" class="common-btn-outlined btn-sm"
                                                onclick="loadKeysInstructionsModal('SANDBOX')">
                                                <i class="bi bi-info-circle"></i> Instructions
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                {{else}}
                                <div id="generateKeyContainer-SANDBOX">
                                    <div class="d-flex align-items-center">
                                        <button data-cyid="generateKey-SANDBOX" id="generateKeyBtn-SANDBOX"
                                            class="common-btn-primary btn-sm {{#if @root.isReadOnlyMode}}disabled{{/if}}"
                                            style="{{#if @root.isReadOnlyMode}}pointer-events: none; opacity: 0.5;{{/if}}"
                                            onclick="generateApplicationKey('keysview-{{../id}}-SANDBOX', '{{../../applicationMetadata.id}}', 'SANDBOX', '{{../name}}', '{{../../applicationMetadata/name}}', '{{ json ../../subAPIs}}', '{{../../orgID}}', 'consumer-key-{{../id}}-SANDBOX', 'consumer-secret-{{../id}}-SANDBOX')">
                                            <span class="button-normal-state">
                                                <i class="bi bi-key me-1"></i> Generate Key
                                            </span>
                                            <span class="button-loading-state" style="display: none;">
                                                <span class="spinner-border spinner-border-sm me-1"
                                                    role="status"></span>
                                                Generating...
                                            </span>
                                        </button>
                                        <div class="tooltip-container ms-2">
                                            <i class="bi bi-info-circle"></i>
                                            <span class="tooltip-text">This key is shared among all APIs</span>
                                        </div>
                                    </div>
                                </div>
                                {{/if}}
                                {{/let}}
                                {{/if}}
                                <!-- Error message container for key generation and token generation -->
                                <div id="keyGenerationErrorContainer-SANDBOX" class="mt-2 text-danger"
                                    style="display: none; font-size: 0.75rem; word-wrap: break-word;"></div>
                                {{/each}}
                            </div>
                        </div>
                    </div>
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingFour">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                data-bs-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
                                API Keys
                            </button>
                        </h2>
                        <div id="collapseFour" class="accordion-collapse collapse" aria-labelledby="headingFour"
                            data-bs-parent="#sandboxAccordion">
                            <div class="accordion-body p-0">
                                {{#if subAPIs}}
                                <div class="app-table-container" id="app-table-container">
                                    <table class="app-table" id="app-table-{{applicationMetadata.id}}">
                                        <thead>
                                            <tr>
                                                <th class="app-th">Name</th>
                                                <th class="app-th">Version</th>
                                                <th class="app-th" style="display: none;">Policy</th>
                                                <th class="app-th">
                                                    {{#if isApiKey}}
                                                    API Key
                                                    {{/if}}
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {{#each subAPIs}}
                                            {{> api-key apiID=apiID keyType="SANDBOX"}}
                                            {{#in apiType values="REST, WS"}}
                                            {{> update-plan subscriptionPolicyDetails=subscriptionPolicyDetails
                                            selectedPlan=policyName appID=../applicationMetadata.id subID=subID}}
                                            <tr class="data-row" id="data-row-{{subID}}" data-index="{{@index}}">
                                                <td class="app-td">
                                                    <span
                                                        onclick="window.location.href='{{@root.baseUrl}}/api/{{apiHandle}}'"
                                                        class="text-truncate d-block"
                                                        style="cursor: pointer;">{{name}}</span>
                                                </td>
                                                <td onclick="window.location.href='{{@root.baseUrl}}/api/{{apiHandle}}'"
                                                    class="app-td" style="cursor: pointer;">{{version}}</td>
                                                <td class="app-td">
                                                    {{#if (contains security 'api_key')}}
                                                    <div class="api-key-actions">
                                                        <button
                                                            class="common-btn-outlined btn-sm me-1 {{#if @root.isReadOnlyMode}}disabled{{/if}}"
                                                            id="regenerateKeyBtn-{{subID}}-SANDBOX"
                                                            data-scopes="{{json apiKeys.sandbox.scopes}}"
                                                            data-api-key-id="'{{apiKeys.sandbox.key.[0].id}}'"
                                                            onclick="openWarningModal('regenerate', this.dataset.apiKeyId, '{{subID}}', '', '', 'SANDBOX')"
                                                            style="{{#if @root.isReadOnlyMode}}pointer-events: none; opacity: 0.5;{{else}}{{#if apiKeys.sandbox.key}}display:inline-flex;{{else}}display:none;{{/if}}{{/if}}">
                                                            <span class="button-normal-state">
                                                                <i class="bi bi-key me-1"></i> Regenerate
                                                            </span>
                                                            <span class="button-loading-state" style="display: none;">
                                                                <span class="spinner-border spinner-border-sm me-1"
                                                                    role="status"></span>
                                                                Regenerate...
                                                            </span>
                                                        </button>
                                                        <button
                                                            class="common-btn-outlined btn-sm api-key-revoke {{#if @root.isReadOnlyMode}}disabled{{/if}}"
                                                            data-api-key-id="'{{apiKeys.sandbox.key.[0].id}}'"
                                                            onclick="openWarningModal('revoke', this.dataset.apiKeyId, '{{subID}}', '{{../applicationMetadata.id}}', '{{refID}}', 'SANDBOX')"
                                                            id="revokeKeyBtn-{{subID}}-SANDBOX"
                                                            style="{{#if @root.isReadOnlyMode}}pointer-events: none; opacity: 0.5;{{else}}{{#if apiKeys.sandbox.key}}display: inline-flex;{{else}}display: none;{{/if}}{{/if}}">
                                                            <span class="button-normal-state">
                                                                <i class="bi bi-key me-1"></i> Revoke
                                                            </span>
                                                            <span class="button-loading-state" style="display: none;">
                                                                <span class="spinner-border spinner-border-sm me-1"
                                                                    role="status"></span>
                                                                Revoking...
                                                            </span>
                                                        </button>
                                                        <button
                                                            class="common-btn-outlined btn-sm me-1 {{#if @root.isReadOnlyMode}}disabled{{/if}}"
                                                            id="generateKeyBtn-{{subID}}-SANDBOX"
                                                            style="{{#if apiKeys.sandbox.key}}display: none;{{else}}display: inline-flex;{{/if}}"
                                                            data-app-ref-id=""
                                                            onclick="openApiKeyModal('{{projectId}}', '{{refID}}', '{{policyName}}', '{{../applicationMetadata.appMap.[0].appRefID}}', '{{../applicationMetadata.id}}', '{{subID}}', '{{getSubIDs ../subAPIs}}', '{{json scopes}}', 'SANDBOX')">
                                                            <span class="button-normal-state">
                                                                <i class="bi bi-key me-1"></i> Generate Key
                                                            </span>
                                                            <span class="button-loading-state" style="display: none;">
                                                                <span class="spinner-border spinner-border-sm me-1"
                                                                    role="status"></span>
                                                                Generating...
                                                            </span>
                                                        </button>
                                                    </div>
                                                    {{/if}}
                                                </td>
                                            </tr>
                                            {{/in}}
                                            {{/each}}
                                        </tbody>
                                    </table>
                                </div>
                                {{/if}}
                                <div class="ps-3" id="no-subscription"
                                    style="{{#if subAPIs.length}}display:none{{/if}}">
                                    <div class="info-box">
                                        <div class="info-content">
                                            <div class="info-title">
                                                No subscriptions available for this application. Please subscribe to an
                                                API to generate an API Key.
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {{> warning }}
    </section>
</main>
